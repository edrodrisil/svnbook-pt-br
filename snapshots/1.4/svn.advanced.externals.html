<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Definições Externas</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.74.0" /><link rel="home" href="index.html" title="Controle de Versão com Subversion" /><link rel="up" href="svn.advanced.html" title="Capítulo 3. Tópicos Avançados" /><link rel="prev" href="svn.advanced.locking.html" title="Travamento" /><link rel="next" href="svn.advanced.pegrevs.html" title="Revisões Marcadoras e Revisões Operativas" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Definições Externas</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="svn.advanced.locking.html">Anterior</a> </td><th width="60%" align="center">Capítulo 3. Tópicos Avançados</th><td width="20%" align="right"> <a accesskey="n" href="svn.advanced.pegrevs.html">Próxima</a></td></tr></table><hr /></div><div class="sect1" lang="pt-br" xml:lang="pt-br"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="svn.advanced.externals"></a>Definições Externas</h2></div></div></div><p>Às vezes, é útil construir uma cópia de trabalho que é
      composta por diferentes <span class="foreignphrase"><em class="foreignphrase">checkouts</em></span>.
      Por exemplo, talvez você queira que diferentes subdiretórios venham
      de diferentes locais em um repositório, ou até mesmo de diferentes
      repositórios. Você poderia configurar tal cenário manualmente—
      usando <span class="command"><strong>svn checkout</strong></span> para criar o tipo de estrutura
      aninhada de cópia de trabalho que você está tentando construir.
      Mas, se essa estrutura é importante para todos os que usam seu
      repositório, todos os outros usuários precisarão realizar
      as mesmas operações de <span class="foreignphrase"><em class="foreignphrase">checkout</em></span> que
      você fez.</p><p>Felizmente, o Subversion provê suporte para
      <em class="firstterm">definições externas</em>.  Uma definição
      externa é um mapeamento de um diretório local para a URL—e,
      idealmente, uma determinada revisão—de um diretório sob
      controle de versão.  No Subversion, você declara definições
      externas em conjunto usando a propriedade <code class="literal">svn:externals</code>.
      Você pode criar ou modificar essa propriedade usando
      <span class="command"><strong>svn propset</strong></span> ou <span class="command"><strong>svn
      propedit</strong></span> (veja <a class="xref" href="svn.advanced.props.html#svn.advanced.props.manip" title="Manipulando Propriedades">“Manipulando Propriedades”</a>).
      Essa propriedade pode ser configurada em qualquer diretório sob
      controle de versão, e seu valor é uma tabela multilinha de
      subdiretórios (relativos ao diretório sob controle de versão no
      qual a propriedade está configurada), opções de revisão, e URLs
      absolutas (totalmente qualificadas) de repositórios Subversion.</p><pre class="screen">
$ svn propget svn:externals calc
third-party/sounds             http://sounds.red-bean.com/repos
third-party/skins              http://skins.red-bean.com/repositories/skinproj
third-party/skins/toolkit -r21 http://svn.red-bean.com/repos/skin-maker
</pre><p>A conveniência da propriedade <code class="literal">svn:externals</code>
      é que, uma vez configurada em um diretório sob controle de versão,
      qualquer pessoa que obtém uma cópia de trabalho desse diretório
      também é beneficiada pelas definições externas.  Em outras palavras,
      uma vez que alguém investiu tempo e esforço para definir essa cópia
      de trabalho feita de <span class="foreignphrase"><em class="foreignphrase">checkouts</em></span> aninhados,
      ninguém mais precisa se incomodar—o Subversion, através do
      <span class="foreignphrase"><em class="foreignphrase">checkout</em></span> da cópia de trabalho
      original, também obterá as cópias de trabalho externas.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Atenção</h3><p>Os subdiretórios alvos relativos das definições
        externas <span class="emphasis"><em>não podem</em></span> existir no seu sistema
        de arquivos nem no de outros usuários—o Subversion irá criá-los
        quando obter a cópia de trabalho externa.</p></div><p>Note o exemplo anterior de definições externas.  Quando
      alguém obtém uma cópia de trabalho do diretório
      <code class="filename">calc</code>, o Subversion também obtém os itens
      encontrados nas suas definições externas.</p><pre class="screen">
$ svn checkout http://svn.example.com/repos/calc
A  calc
A  calc/Makefile
A  calc/integer.c
A  calc/button.c
Checked out revision 148.

Fetching external item into calc/third-party/sounds
A  calc/third-party/sounds/ding.ogg
A  calc/third-party/sounds/dong.ogg
A  calc/third-party/sounds/clang.ogg
…
A  calc/third-party/sounds/bang.ogg
A  calc/third-party/sounds/twang.ogg
Checked out revision 14.

Fetching external item into calc/third-party/skins
…
</pre><p>Se você precisar mudar as definições externas, você pode fazer isso
      usando os subcomandos para modificação de propriedades normalmente.
      Quando você submeter uma alteração na propriedade
      <code class="literal">svn:externals</code>, o Subversion irá sincronizar os itens
      submetidos com as definições externas na próxima vez que você executar um
      <span class="command"><strong>svn update</strong></span>.  A mesma coisa irá acontecer quando outros
      atualizarem suas cópias de trabalho e recebam as suas modificações nas
      definições externas.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Dica</h3><p>Como o valor da propriedade <code class="literal">svn:externals</code> é um
        conteúdo de múltiplas linhas, nós recomendamos fortemente que você use
        o <span class="command"><strong>svn propedit</strong></span> ao invés do <span class="command"><strong>svn
        propset</strong></span>.</p></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Dica</h3><p>Você deveria considerar seriamente o uso de um número de revisão
        explícito em todas as suas definições externas.  Fazer isso significa
        que você tem que decidir quando trazer um diferente registro
        instantâneo de uma informação externa, e exatamente qual instantâneo
        trazer.  Além de evitar a surpresa de obter mudanças de repositórios de
        terceiros sobre as quais você pode não ter nenhum controle, usar número
        de revisão explícitos também significa que conforme você voltar no
        tempo sua cópia de trabalho para uma revisão anterior, suas definições
        externas também serão revertidas para a forma como estavam na revisão
        passada, o que por sua vez significa que as cópias de trabalho serão
        atualizadas de volta para corresponder à forma como
        <span class="emphasis"><em>elas</em></span> se pareciam quando seu repositório estava
        naquela revisão anterior.  Para projetos de software, isso poderia ser
        a diferença entre uma compilação de sucesso ou uma falha em um momento
        passado de sua complexa base de código.</p></div><p>O comando <span class="command"><strong>svn status</strong></span> também reconhece definições
      externas, exibindo um código de status <code class="literal">X</code> para
      subdiretórios desmembrados nos quais as externas foram obtidas, e então
      varrer recursivamente dentro destes subdiretórios para mostrar o status
      dos próprios itens externos.</p><p>O suporte que existe para definições externas no Subversion ainda
      está abaixo do ideal.  Primeiro, uma definição externa pode apenas
      apontar para diretórios, não para arquivos.  Segundo, as definições
      externas não podem apontar para caminhos relativos (tais como
      <code class="filename">../../skins/myskin</code>).  Terceiro, o suporte a cópias
      de trabalho criadas por meio de definições externas ainda está
      desconectado da cópia de trabalho primária (na qual a propriedade
      <code class="literal">svn:externals</code> dos diretórios versionados foi
      atualmente definida).  E o Subversion ainda só pode operar
      verdadeiramente em cópias de trabalho não-desmembradas.  Então, por
      exemplo, se você quiser submeter as alterações que você tenha feito em um
      ou mais destas cópias de trabalho externas, você deve executar um
      <span class="command"><strong>svn commit</strong></span> explicitamente nessas cópias de
      trabalho—submeter alterações numa cópia de trabalho não irá
      implicar numa recursão dentro de nenhuma das externas.</p><p>E também, como as definições externas em si usam URLs absolutas, a
      movimentação ou cópia de um diretório ao qual elas estejam anexadas não
      afetará aquela obtida como uma externa (ainda que o subdiretório local de
      destino relativo seja, é claro, movido com o diretório renomeado).  Isto
      pode ser confuso—ou mesmo frustrante—em certas situações.
      Por exemplo, digamos que você tenha um diretório de alto nível chamado
      <code class="filename">my-project</code>, e que você tenha criado uma definição
      externa em um de seus subdiretórios
      (<code class="filename">my-project/some-dir</code>) que acompanha a última revisão
      de outro de seus subdiretórios 
      (<code class="filename">my-project/external-dir</code>).</p><pre class="screen">
$ svn checkout http://svn.example.com/projects .
A    my-project
A    my-project/some-dir
A    my-project/external-dir
…
Fetching external item into 'my-project/some-dir/subdir'
Checked out external at revision 11.

Checked out revision 11.
$ svn propget svn:externals my-project/some-dir
subdir http://svn.example.com/projects/my-project/external-dir

$
</pre><p>Agora você executa <span class="command"><strong>svn move</strong></span> para renomear o
      diretório <code class="filename">my-project</code> directory.  Neste ponto, sua
      definição externa ainda vai se referir ao caminho relacionado ao
      diretório <code class="filename">my-project</code>, muito embora esse diretório
      não exista mais.</p><pre class="screen">
$ svn move -q my-project renamed-project
$ svn commit -m "Rename my-project to renamed-project."
Deleting       my-project
Adding         my-renamed-project

Committed revision 12.
$ svn update

Fetching external item into 'renamed-project/some-dir/subdir'
svn: Target path does not exist
$
</pre><p>E também, as URLs absolutas que as definições externas usam podem
      causar problemas com repositórios que estejam disponíveis a partir de
      múltiplos esquemas de URL.  Por exemplo, se seu servidor Subversion
      estiver configurado para permitir que qualquer um obtenha o conteúdo do
      repositório por meio de <code class="literal">http://</code> ou
      <code class="literal">https://</code>, mas que apenas possam submeter alterações
      através de <code class="literal">https://</code>, você tem um interessante problema
      em mãos.  Se suas definições externas usam o formato
      <code class="literal">http://</code> para URLs do repositório, você não será capaz
      de submeter nada a partir das cópias de trabalho criadas por definições
      externas.  Por outro lado, se elas usam o formato
      <code class="literal">https://</code> para URLs, qualquer pessoa que tenha obtido a
      cópia através de <code class="literal">http://</code> por não ter um cliente com
      suporte a <code class="literal">https://</code> estará impossibilitado de buscar
      itens externos.  Atente também que se você precisar realocar sua cópia de
      trabalho (usando <span class="command"><strong>svn switch --relocate</strong></span>), suas
      definições externas <span class="emphasis"><em>não</em></span> serão realocadas.</p><p>Finalmente, pode ser que algumas vezes você prefira que os
      subcomandos não reconheçam <span class="command"><strong>svn</strong></span>, ou mesmo não operem
      sobre cópias de trabalhos externas.  Nesses casos, você pode passar a
      opção <code class="option">--ignore-externals</code> para o subcomando.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="svn.advanced.locking.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="svn.advanced.html">Acima</a></td><td width="40%" align="right"> <a accesskey="n" href="svn.advanced.pegrevs.html">Próxima</a></td></tr><tr><td width="40%" align="left" valign="top">Travamento </td><td width="20%" align="center"><a accesskey="h" href="index.html">Principal</a></td><td width="40%" align="right" valign="top"> Revisões Marcadoras e Revisões Operativas</td></tr></table></div></body></html>
